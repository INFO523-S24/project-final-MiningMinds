{
  "hash": "54760d101b77e5c1ed12a8acffcc94b9",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Fraud Detection Using Ensemble Learning\nsubtitle: 'Team : Mining Minds -INFO 523- Spring 2023 - Project Final'\nauthor: 'Omid Zandi,Nandhini Anne, Sai Navya Reddy Busireddy, Gowtham Gopalkrishnan, Roxana Akbarsharifi, Deema Albluwi'\ntitle-slide-attributes:\n  data-background-image: images/title1.png\n  data-background-size: stretch\n  data-background-opacity: '0.2'\n  data-slide-number: none\nformat:\n  revealjs:\n    theme:\n      - data/customtheming.scss\n    background-transition: fade\n    transition: slide\n    auto-animate-duration: 1.5\n    scrollable: true\n    logo: images/credit_card_fraud.jpeg\n    footer: \"[\\U0001F4B5 MiningMinds](https://info523-s24.github.io/project-final-MiningMinds/)\"\neditor: visual\nexecute:\n  echo: false\n  warning: false\n  message: false\neditor_options:\n  chunk_output_type: console\n---\n\n\n\n## Introduction {style=\"font-size: 0.7em;\"}\n::: incremental\n\n-   The primary goal of our project is to enhance machine learning models accuracy in detecting fraudulent credit card transactions using an ensemble learning technique known as stacked generalization.\n\n-   The motivation behind our project is to improve the detection of fraudulent transactions, which remains a significant challenge in financial security.\n\n-   By integrating multiple predictive models, the project aims to create a robust system that can more accurately identify fraudulent transactions, thus contributing to safer financial environments.\n\n-   Despite challenges like data imbalance and feature anonymization, we anticipate that stacked generalization will enhance fraud detection accuracy, demonstrating the effectiveness of ensemble methods in complex scenarios.\n\n:::\n\n## Dataset description {style=\"font-size: 0.7em;\"}\n::: incremental\n-   The dataset comprises over 550,000 credit card transactions from European cardholders, collected in 2023.\n\n-   It includes 31 features with transaction details such as amount and time, anonymized to ensure privacy and ethical compliance.\n\n-   The anonymization of features presents challenges in interpreting the data, while the class imbalance poses difficulties in model training and accuracy.\n\n:::\n\n\n\n## Preview of the Dataset: First Few Transactions {style=\"font-size: 0.7em;\"}\n\n::: {#cell-Reading the dataset .cell execution_count=3}\n\n::: {#reading-the-dataset .cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Time</th>\n      <th>V1</th>\n      <th>V2</th>\n      <th>V3</th>\n      <th>V4</th>\n      <th>V5</th>\n      <th>V6</th>\n      <th>V7</th>\n      <th>V8</th>\n      <th>V9</th>\n      <th>...</th>\n      <th>V21</th>\n      <th>V22</th>\n      <th>V23</th>\n      <th>V24</th>\n      <th>V25</th>\n      <th>V26</th>\n      <th>V27</th>\n      <th>V28</th>\n      <th>Amount</th>\n      <th>Class</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>-1.359807</td>\n      <td>-0.072781</td>\n      <td>2.536347</td>\n      <td>1.378155</td>\n      <td>-0.338321</td>\n      <td>0.462388</td>\n      <td>0.239599</td>\n      <td>0.098698</td>\n      <td>0.363787</td>\n      <td>...</td>\n      <td>-0.018307</td>\n      <td>0.277838</td>\n      <td>-0.110474</td>\n      <td>0.066928</td>\n      <td>0.128539</td>\n      <td>-0.189115</td>\n      <td>0.133558</td>\n      <td>-0.021053</td>\n      <td>149.62</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.0</td>\n      <td>1.191857</td>\n      <td>0.266151</td>\n      <td>0.166480</td>\n      <td>0.448154</td>\n      <td>0.060018</td>\n      <td>-0.082361</td>\n      <td>-0.078803</td>\n      <td>0.085102</td>\n      <td>-0.255425</td>\n      <td>...</td>\n      <td>-0.225775</td>\n      <td>-0.638672</td>\n      <td>0.101288</td>\n      <td>-0.339846</td>\n      <td>0.167170</td>\n      <td>0.125895</td>\n      <td>-0.008983</td>\n      <td>0.014724</td>\n      <td>2.69</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1.0</td>\n      <td>-1.358354</td>\n      <td>-1.340163</td>\n      <td>1.773209</td>\n      <td>0.379780</td>\n      <td>-0.503198</td>\n      <td>1.800499</td>\n      <td>0.791461</td>\n      <td>0.247676</td>\n      <td>-1.514654</td>\n      <td>...</td>\n      <td>0.247998</td>\n      <td>0.771679</td>\n      <td>0.909412</td>\n      <td>-0.689281</td>\n      <td>-0.327642</td>\n      <td>-0.139097</td>\n      <td>-0.055353</td>\n      <td>-0.059752</td>\n      <td>378.66</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.0</td>\n      <td>-0.966272</td>\n      <td>-0.185226</td>\n      <td>1.792993</td>\n      <td>-0.863291</td>\n      <td>-0.010309</td>\n      <td>1.247203</td>\n      <td>0.237609</td>\n      <td>0.377436</td>\n      <td>-1.387024</td>\n      <td>...</td>\n      <td>-0.108300</td>\n      <td>0.005274</td>\n      <td>-0.190321</td>\n      <td>-1.175575</td>\n      <td>0.647376</td>\n      <td>-0.221929</td>\n      <td>0.062723</td>\n      <td>0.061458</td>\n      <td>123.50</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2.0</td>\n      <td>-1.158233</td>\n      <td>0.877737</td>\n      <td>1.548718</td>\n      <td>0.403034</td>\n      <td>-0.407193</td>\n      <td>0.095921</td>\n      <td>0.592941</td>\n      <td>-0.270533</td>\n      <td>0.817739</td>\n      <td>...</td>\n      <td>-0.009431</td>\n      <td>0.798278</td>\n      <td>-0.137458</td>\n      <td>0.141267</td>\n      <td>-0.206010</td>\n      <td>0.502292</td>\n      <td>0.219422</td>\n      <td>0.215153</td>\n      <td>69.99</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 31 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Exploratory Data Analysis\n::: panel-tabset\n\n### Kernel Distribution\n![](images/kernel.png)\n\n### PCA\n![](images/pca.png)\n\n:::\n\n\n\n\n## Research Questions {style=\"font-size: 0.7em;\"}\n::: incremental\n\n-   What is the comparative performance of anomaly detection algorithms, including Random Forest, XGBoost, KNN, for fraud detection in this specific dataset?\n\n-   How does the stacked generalization technique, implemented with the mlxtend library, improve fraud detection performance by leveraging the synergy between base classifiers?\n\n:::\n\n## Question1: Analysis Plan {style=\"font-size: 0.7em;\"}\n::: incremental\n\n-  <b>Model Training and Sampling Techniques:</b> Address dataset imbalance by oversampling the minority class and undersampling the majority. Split the data into training and testing sets, and train anomaly detection models including Random Forest, XGBoost, and KNN.\n\n-  <b>Model Optimization:</b> Hypertune the models to optimize performance, ensuring the best possible settings for each algorithm.\n\n-  <b>Performance Evaluation and Analysis:</b> Evaluate each model on the testing set using metrics like precision, recall, F1-score, and ROC area. Analyze performance differences to understand the impact of model complexity, feature importance, and dataset characteristics.\n\n:::\n\n\n\n\n## Question2: Analysis Plan {style=\"font-size: 0.7em;\"}\n::: incremental\n\n-  <b>Stacked Generalization Setup:</b> Utilize the mlxtend library to implement stacked generalization. Train base models as specified, and split their output into training and testing sets for the meta-classifier.\n\n-  <b>Meta-classifier Training:</b> Combine predictions from base classifiers using the stacking method, and train a meta-classifier on these combined predictions to enhance prediction accuracy.\n\n-  <b>Evaluation and Analysis:</b> Assess the performance of the stacked model, compare it to the base models, and analyze the performance gains, focusing on factors like model diversity, ensemble principles, and dataset specifics.\n\n:::\n\n\n## Random Undersampling {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n### PlotA\n![](images/comparision.png)\n\n### PlotB\n![](images/undersampling.png)\n\n:::\n\n\n## Classification Models {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n\n## RandomForest\n![](images/s_rff.png)\n\n## KNN\n![](images/s_knn.png)\n\n## XGBoost\n![](images/s_xg.png)\n\n## Stacked Model\n![](images/s_stacked.png)\n\n:::\n\n## Metrics for Classification Models {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n\n### Metrics\n Metric | RF | KNN | XGBoost | Stacked |\n|----------|----------|----------|----------|----------|\n| Accuracy | 0.98 | 0.98 | 0.97 | 0.97 |\n| Precision | 0.08 | 0.08 | 0.05 | 0.05 |\n| Recall | 0.96 | 0.91 | 0.99 | 0.99 |\n| F1-Score | 0.14 | 0.14 | 0.09 | 0.09 |\n\n### Analysis\n\n-  Overall, Random Forest demonstrates a slight edge, where all other models exhibit commendable performance in this classification task, underscoring their effectiveness in predictive modeling. \n\n:::\n\n\n\n## ROC {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n\n## Plot\n![](images/roc.png)\n\n## Analysis\n\n::: incremental\n- <b>Excellent Performance:</b> The ROC curves for four classifiers—Random Forest, K-Nearest Neighbors (KNN), XGBoost, and a Stacked Classifier—indicate high performance, with AUC values all above 0.98. Random Forest and XGBoost display the best performance, both achieving an AUC of 0.989, demonstrating their high effectiveness in discriminating between classes. The Stacked Classifier, despite combining features of multiple models, performs slightly lower than the top individual models with an AUC of 0.98. This suggests that while all models are highly capable, Random Forest and XGBoost might be preferred due to their marginally superior performance.\n\n\n\n:::\n\n:::\n\n\n\n\n\n\n## Evaluation using the Whole Dataset {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n\n### RandomForest\n![](images/rff.png)\n\n### KNN\n![](images/knn.png)\n\n### XGBoost\n![](images/xg.png)\n\n### Stacked Model\n![](images/stacked.png)\n\n:::\n\n## Metrics for Evaluation using whole dataset {style=\"font-size: 0.7em;\"}\n::: panel-tabset\n\n### Metrics\n\n| Metric | RF | KNN | XGBoost | Stacked |\n|----------|----------|----------|----------|----------|\n| Accuracy | 0.98 | 0.98 | 0.97 | 0.97 |\n| Precision | 0.08 | 0.08 | 0.05 | 0.05 |\n| Recall | 0.96 | 0.91 | 0.99 | 0.99 |\n| F1-Score | 0.14 | 0.14 | 0.09 | 0.09 |\n\n### Analysis\n\n-   Precision is notably low for all classifiers, ranging from 0.05 to 0.08. Precision measures the proportion of positive identifications that were actually correct. These low scores suggest that while the models are good at finding positive cases (fraudulent transactions, for example), a large proportion of these predictions are false positives.\n\n:::\n\n\n## Future Implications {style=\"font-size: 0.7em;\"}\n::: incremental\n\n-   SMOTE stands for Synthetic Minority Over-sampling Technique, a statistical technique designed to balance your dataset by increasing the number of cases. Instead of merely duplicating examples, SMOTE generates synthetic samples from the minority class—the class with fewer instances. This approach effectively addresses the overfitting issue that arises when examples from the minority class are simply replicated.\n\n-   using a more diverse set of machine learning models combined with a more sophisticated meta-learner can lead to more accurate results.\n:::\n\n##\n![](images/thankyou.jpg){style=\"width:100%;height:100%;\"}\n\n",
    "supporting": [
      "presentation_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}